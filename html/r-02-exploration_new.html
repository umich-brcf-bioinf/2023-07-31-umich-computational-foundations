<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Exploration</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/computer/
-->
<meta name="google-site-verification" content="t-Wgs-RXt8xi94RSoFamxoD2P2h-Hh7M_t_iOuxFZUo" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computational Foundations</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Bash Shell
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bash-01-introduction.html">Introducing the Shell</a>
    </li>
    <li>
      <a href="bash-02-the-filesystem.html">Navigating Files and Directories</a>
    </li>
    <li>
      <a href="bash-03-working-with-files.html">Working with Files</a>
    </li>
    <li>
      <a href="bash-04-redirection.html">Redirection</a>
    </li>
    <li>
      <a href="bash-05-writing-scripts.html">Writing Scripts and Working with Data</a>
    </li>
    <li>
      <a href="bash-06-organization.html">Project Organization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    R and RStudio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r-01-introduction.html">Introducing R and RStudio IDE</a>
    </li>
    <li>
      <a href="r-02-r-basics.html">R Basics</a>
    </li>
    <li>
      <a href="r-03-basics-continued.html">R Basics Continued</a>
    </li>
    <li>
      <a href="r-04-bioconductor.html">Using Packages from Bioconductor</a>
    </li>
    <li>
      <a href="r-05-dplyr.html">Data Wrangling and Analyses with Tidyverse</a>
    </li>
    <li>
      <a href="r-06-data-visualization.html">Data Visualizations with ggplot2</a>
    </li>
    <li>
      <a href="r-07-r-help.html">Getting Help with R</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Data Exploration</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#objectives" id="toc-objectives">Objectives</a></li>
<li><a href="#loading-data" id="toc-loading-data">Loading data</a></li>
<li><a href="#exploring-data" id="toc-exploring-data">Exploring data</a>
<ul>
<li><a href="#get-stats-with-summary"
id="toc-get-stats-with-summary">Get stats with
<code>summary()</code></a></li>
<li><a href="#get-stats-with-summarize"
id="toc-get-stats-with-summarize">Get stats with
<code>summarize()</code></a></li>
<li><a href="#find-unique-values-with-distinct"
id="toc-find-unique-values-with-distinct">Find unique values with
<code>distinct()</code></a></li>
<li><a href="#subset-columns-with-select"
id="toc-subset-columns-with-select">Subset columns with
<code>select()</code></a></li>
<li><a href="#narrow-down-rows-with-filter"
id="toc-narrow-down-rows-with-filter">Narrow down rows with
<code>filter()</code></a></li>
<li><a href="#make-new-columns-with-mutate"
id="toc-make-new-columns-with-mutate">Make new columns with
<code>mutate()</code></a></li>
<li><a href="#combine-functions-with-the-pipe"
id="toc-combine-functions-with-the-pipe">Combine functions with the
<code>%&gt;%</code> pipe</a></li>
<li><a href="#group-rows-with-group_by"
id="toc-group-rows-with-group_by">Group rows with
<code>group_by()</code></a></li>
</ul></li>
<li><a href="#exploring-data-visually"
id="toc-exploring-data-visually">Exploring data visually</a></li>
</ul>
</div>

<style type="text/css">

body, td {
   font-size: 14px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}

</style>
<div id="objectives" class="section level1">
<h1>Objectives</h1>
<ul>
<li>Subset, filter, and summarize data with <code>dplyr</code>
functions. Highlight base R equivalents.</li>
<li>Create plots with both discrete and continuous variables with
<code>ggplot2</code>.</li>
<li>Understand mapping and layering in <code>ggplot2</code>.</li>
<li>Modify the color, theme, and axis labels of a plot.</li>
</ul>
</div>
<div id="loading-data" class="section level1">
<h1>Loading data</h1>
<p>In the previous lesson we used the <code>read_csv()</code> function
to load the <code>gapminder_1997</code> data. Let’s do that again:</p>
<pre class="r"><code>gapminder_1997 = read_csv(&#39;data/gapminder_1997.csv&#39;)</code></pre>
<pre><code>Rows: 142 Columns: 6
── Column specification ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (2): country, continent
dbl (4): year, pop, lifeExp, gdpPercap

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>This time, let’s look more closely at the data. If we type the name
of the object and evaluate it, we’ll see a preview:</p>
<pre class="r"><code>gapminder_1997</code></pre>
<pre><code># A tibble: 142 × 6
   country      year       pop continent lifeExp gdpPercap
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1997  22227415 Asia         41.8      635.
 2 Albania      1997   3428038 Europe       73.0     3193.
 3 Algeria      1997  29072015 Africa       69.2     4797.
 4 Angola       1997   9875024 Africa       41.0     2277.
 5 Argentina    1997  36203463 Americas     73.3    10967.
 6 Australia    1997  18565243 Oceania      78.8    26998.
 7 Austria      1997   8069876 Europe       77.5    29096.
 8 Bahrain      1997    598561 Asia         73.9    20292.
 9 Bangladesh   1997 123315288 Asia         59.4      973.
10 Belgium      1997  10199787 Europe       77.5    27561.
# ℹ 132 more rows</code></pre>
<p>The output shows we have “a tibble” and its dimensions are 142 rows
by 6 columns. We then see:</p>
<ul>
<li>Column headings (country, year, etc)</li>
<li>Column data types (chr, dbl, etc)</li>
<li>The entries of the first 10 rows.</li>
</ul>
<p>Data in the form of a table is very common in R. The “base R” type is
called a <code>data.frame</code>. The <code>tidyverse</code> extends on
this notion with a <code>tibble</code>. The commands we’ll learn in this
lesson work on <code>data.frame</code>s and <code>tibble</code>s. We’ll
use <code>data.frame</code>, <code>tibble</code>, and “data table”
interchangeably throughout the lessons.</p>
</div>
<div id="exploring-data" class="section level1">
<h1>Exploring data</h1>
<p>After reading in data, it’s a good habit to preview it, look at
summaries of it, and, in so doing, look for issues. When data contains
hundreds of rows, it’s a good idea to get a sense for the values and
ranges of the data.</p>
<div id="get-stats-with-summary" class="section level2">
<h2>Get stats with <code>summary()</code></h2>
<p>The <code>summary()</code> function, from base R, takes a data table
as input and will summarize the columns automatically depending on their
data type.</p>
<pre class="r"><code>summary(gapminder_1997)</code></pre>
<pre><code>   country               year           pop             continent            lifeExp        gdpPercap      
 Length:142         Min.   :1997   Min.   :1.456e+05   Length:142         Min.   :36.09   Min.   :  312.2  
 Class :character   1st Qu.:1997   1st Qu.:3.770e+06   Class :character   1st Qu.:55.63   1st Qu.: 1366.8  
 Mode  :character   Median :1997   Median :9.735e+06   Mode  :character   Median :69.39   Median : 4781.8  
                    Mean   :1997   Mean   :3.884e+07                      Mean   :65.01   Mean   : 9090.2  
                    3rd Qu.:1997   3rd Qu.:2.431e+07                      3rd Qu.:74.17   3rd Qu.:12022.9  
                    Max.   :1997   Max.   :1.230e+09                      Max.   :80.69   Max.   :41283.2  </code></pre>
<p>We see that for the numeric data we get quantile information and the
mean, whereas for character data we simply get the length of the
column.</p>
</div>
<div id="get-stats-with-summarize" class="section level2">
<h2>Get stats with <code>summarize()</code></h2>
<p>If we wanted to know the mean life expectancy in the dataset, we
could use the built in function <code>mean()</code>. If we combine this
with the <code>dplyr</code> <code>summarize()</code> function, we’ll
get:</p>
<pre class="r"><code>summarize(gapminder_1997, avgLifeExp = mean(lifeExp))</code></pre>
<pre><code># A tibble: 1 × 1
  avgLifeExp
       &lt;dbl&gt;
1       65.0</code></pre>
<p>We can use any column name, so long as it’s a numeric, and we get a
new object with our value returned as a column. Note, this matches the
result of <code>summary()</code>. Alternatively, we could have simply
applied <code>mean()</code> directly to the column
<code>lifeExp</code>:</p>
<pre class="r"><code>mean(gapminder_1997$lifeExp)</code></pre>
<pre><code>[1] 65.01468</code></pre>
<p>This is a more “base R” way of doing it. Notice we just get a number
back, whereas with <code>summarize()</code> we got a
<code>tibble</code>. Here, the <code>$</code> is a way to access columns
of a data table by name. Another way to express the above is with
square-bracket notation:</p>
<pre class="r"><code>mean(gapminder_1997[, &#39;lifeExp&#39;])</code></pre>
<pre><code>Warning in mean.default(gapminder_1997[, &quot;lifeExp&quot;]): argument is not numeric or logical: returning NA</code></pre>
<pre><code>[1] NA</code></pre>
<p>A data table has two dimensions (rows and columns), and, with
square-bracket accessors, the rows are in the first position and the
columns are in the second position in the brackets separated by a comma.
In the above, leaving the row position blank implies “all rows”, and in
the column position we specify the name of the column. Finally, there is
the <code>with()</code> approach from base R which looks a bit more like
our original call to <code>summarize()</code>:</p>
<pre class="r"><code>with(gapminder_1997, mean(lifeExp))</code></pre>
<pre><code>[1] 65.01468</code></pre>
<p>In this formulation, we can refer to the column without quotes, like
in <code>summarize()</code> and other <code>tidyverse</code> functions
in general.</p>
<blockquote>
<h2 id="tip-reference-columns-by-name">Tip: Reference columns by
name</h2>
<p>While it is possible to access columns by their numerical index, this
is less prefereable than using the explicit name of the column because
altering the table could change the column indices. Depending on the
situation, you might not even get an error, and instead would be simply
operating on the wrong column. A dangerous situation to be in.</p>
</blockquote>
</div>
<div id="find-unique-values-with-distinct" class="section level2">
<h2>Find unique values with <code>distinct()</code></h2>
<p>To quickly data entry problems, the <code>distinct()</code> function
can be used to show all unique values in the column of a table. Let’s
take a look at the distinct values of the continents column:</p>
<pre class="r"><code>distinct(gapminder_1997, continent)</code></pre>
<pre><code># A tibble: 5 × 1
  continent
  &lt;chr&gt;    
1 Asia     
2 Europe   
3 Africa   
4 Americas 
5 Oceania  </code></pre>
<p>Here we get a <code>tibble</code> back with the unique continent
names in their order of appearance. There is an equivalent base R way to
do this with the <code>unique()</code> function:</p>
<pre class="r"><code>unique(gapminder_1997$continent)</code></pre>
<pre><code>[1] &quot;Asia&quot;     &quot;Europe&quot;   &quot;Africa&quot;   &quot;Americas&quot; &quot;Oceania&quot; </code></pre>
<p>Either way, if there was a misspelled entry, for example, “Urope” we
would have immediately seen it.</p>
</div>
<div id="subset-columns-with-select" class="section level2">
<h2>Subset columns with <code>select()</code></h2>
<p>Sometimes data tables have many columns, and it can be useful to
select only a few of them for exporting, use downstream, previewing,
etc. The <code>select()</code> function enables us to select a subset of
columns:</p>
<pre class="r"><code>select(gapminder_1997, country, year, lifeExp)</code></pre>
<pre><code># A tibble: 142 × 3
   country      year lifeExp
   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;
 1 Afghanistan  1997    41.8
 2 Albania      1997    73.0
 3 Algeria      1997    69.2
 4 Angola       1997    41.0
 5 Argentina    1997    73.3
 6 Australia    1997    78.8
 7 Austria      1997    77.5
 8 Bahrain      1997    73.9
 9 Bangladesh   1997    59.4
10 Belgium      1997    77.5
# ℹ 132 more rows</code></pre>
<p>We can do the equivalent <code>select()</code> statement using base R
with:</p>
<pre class="r"><code>gapminder_1997[ , c(&#39;country&#39;, &#39;year&#39;, &#39;lifeExp&#39;)]</code></pre>
<pre><code># A tibble: 142 × 3
   country      year lifeExp
   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;
 1 Afghanistan  1997    41.8
 2 Albania      1997    73.0
 3 Algeria      1997    69.2
 4 Angola       1997    41.0
 5 Argentina    1997    73.3
 6 Australia    1997    78.8
 7 Austria      1997    77.5
 8 Bahrain      1997    73.9
 9 Bangladesh   1997    59.4
10 Belgium      1997    77.5
# ℹ 132 more rows</code></pre>
<p>Here, again, we use the square bracket notation, but we have given a
vector of column names instead of a single one. Here the
<code>c()</code> function, meaning “combine”, creates a temporary vector
of column names.</p>
<p>Columns can be removed using <code>select()</code> with a “minus” in
front of the column name.</p>
<pre class="r"><code>select(gapminder_1997, -year)</code></pre>
<pre><code># A tibble: 142 × 5
   country           pop continent lifeExp gdpPercap
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  22227415 Asia         41.8      635.
 2 Albania       3428038 Europe       73.0     3193.
 3 Algeria      29072015 Africa       69.2     4797.
 4 Angola        9875024 Africa       41.0     2277.
 5 Argentina    36203463 Americas     73.3    10967.
 6 Australia    18565243 Oceania      78.8    26998.
 7 Austria       8069876 Europe       77.5    29096.
 8 Bahrain        598561 Asia         73.9    20292.
 9 Bangladesh  123315288 Asia         59.4      973.
10 Belgium      10199787 Europe       77.5    27561.
# ℹ 132 more rows</code></pre>
<p>Notice the <code>year</code> column is no longer displayed. The
equivalent can be done in base R with:</p>
<pre class="r"><code>gapminder_1997[, -2]</code></pre>
<pre><code># A tibble: 142 × 5
   country           pop continent lifeExp gdpPercap
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  22227415 Asia         41.8      635.
 2 Albania       3428038 Europe       73.0     3193.
 3 Algeria      29072015 Africa       69.2     4797.
 4 Angola        9875024 Africa       41.0     2277.
 5 Argentina    36203463 Americas     73.3    10967.
 6 Australia    18565243 Oceania      78.8    26998.
 7 Austria       8069876 Europe       77.5    29096.
 8 Bahrain        598561 Asia         73.9    20292.
 9 Bangladesh  123315288 Asia         59.4      973.
10 Belgium      10199787 Europe       77.5    27561.
# ℹ 132 more rows</code></pre>
<p>Note, the base R syntax works for numerical column indices only. The
following throws an error if we try to use the name of the column as we
did in the <code>tidyverse</code> syntax:</p>
<pre class="r"><code>gapminder_1997[, -c(&#39;year&#39;)]</code></pre>
<pre><code>Error in -c(&quot;year&quot;): invalid argument to unary operator</code></pre>
<p>Note that if we view <code>gapminder_1997</code> we notice haven’t
changed the original data because we haven’t saved the object.</p>
<pre class="r"><code>gapminder_1997</code></pre>
<pre><code># A tibble: 142 × 6
   country      year       pop continent lifeExp gdpPercap
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1997  22227415 Asia         41.8      635.
 2 Albania      1997   3428038 Europe       73.0     3193.
 3 Algeria      1997  29072015 Africa       69.2     4797.
 4 Angola       1997   9875024 Africa       41.0     2277.
 5 Argentina    1997  36203463 Americas     73.3    10967.
 6 Australia    1997  18565243 Oceania      78.8    26998.
 7 Austria      1997   8069876 Europe       77.5    29096.
 8 Bahrain      1997    598561 Asia         73.9    20292.
 9 Bangladesh   1997 123315288 Asia         59.4      973.
10 Belgium      1997  10199787 Europe       77.5    27561.
# ℹ 132 more rows</code></pre>
<p>To manipulate <code>gapminder_1997</code> and save it as a new object
we have to assign it a new object name:</p>
<pre class="r"><code>gapminder_column_subset = select(gapminder_1997, country, year, lifeExp)
gapminder_column_subset</code></pre>
<pre><code># A tibble: 142 × 3
   country      year lifeExp
   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;
 1 Afghanistan  1997    41.8
 2 Albania      1997    73.0
 3 Algeria      1997    69.2
 4 Angola       1997    41.0
 5 Argentina    1997    73.3
 6 Australia    1997    78.8
 7 Austria      1997    77.5
 8 Bahrain      1997    73.9
 9 Bangladesh   1997    59.4
10 Belgium      1997    77.5
# ℹ 132 more rows</code></pre>
<p>The original data file we read in
<code>data/gapminder_1997.csv</code> remains the same throughout all
these manipulations. What happens in R stays in R until we explicitly
write a new object to the same file. <strong>It’s good practice to keep
raw input data separate, and to never overwrite it.</strong></p>
</div>
<div id="narrow-down-rows-with-filter" class="section level2">
<h2>Narrow down rows with <code>filter()</code></h2>
<p>We have seen that <code>select()</code> subsets the columns of a
table. The function <code>filter()</code> subsets the rows of a data
table based on logical criteria. So first, a note about logical
operators in R:</p>
<table>
<colgroup>
<col width="20%" />
<col width="52%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th>Operator</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;</td>
<td>less than</td>
<td><code>pop &lt; 575990</code></td>
</tr>
<tr class="even">
<td>&lt;=</td>
<td>less than or equal to</td>
<td><code>pop &lt;= 575990</code></td>
</tr>
<tr class="odd">
<td>&gt;</td>
<td>greater than</td>
<td><code>pop &gt; 1000000</code></td>
</tr>
<tr class="even">
<td>&gt;=</td>
<td>greater than or equal to</td>
<td><code>pop &gt;= 38000000</code></td>
</tr>
<tr class="odd">
<td>==</td>
<td>exactly equal to</td>
<td><code>continent == 'Africa'</code></td>
</tr>
<tr class="even">
<td>!=</td>
<td>not equal to</td>
<td><code>continent != 'Asia'</code></td>
</tr>
<tr class="odd">
<td>!x</td>
<td>not x</td>
<td><code>!(continent == 'Africa')</code></td>
</tr>
<tr class="even">
<td>a | b</td>
<td>a or b</td>
<td><code>pop &lt; 575990 | pop &gt; 1000000</code></td>
</tr>
<tr class="odd">
<td>a &amp; b</td>
<td>a and b</td>
<td><code>continent == 'Asia' &amp; continent == 'Africa'</code></td>
</tr>
<tr class="even">
<td>a %in% b</td>
<td>a in b</td>
<td><code>continent %in% c('Asia', 'Africa')</code></td>
</tr>
</tbody>
</table>
<p>With these operators in mind we can filter the
<code>gapminder_1997</code> data table in a variety of ways. To filter
for only the African data we could:</p>
<pre class="r"><code>filter(gapminder_1997, continent == &#39;Africa&#39;)</code></pre>
<pre><code># A tibble: 52 × 6
   country                   year      pop continent lifeExp gdpPercap
   &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Algeria                   1997 29072015 Africa       69.2     4797.
 2 Angola                    1997  9875024 Africa       41.0     2277.
 3 Benin                     1997  6066080 Africa       54.8     1233.
 4 Botswana                  1997  1536536 Africa       52.6     8647.
 5 Burkina Faso              1997 10352843 Africa       50.3      946.
 6 Burundi                   1997  6121610 Africa       45.3      463.
 7 Cameroon                  1997 14195809 Africa       52.2     1694.
 8 Central African Republic  1997  3696513 Africa       46.1      741.
 9 Chad                      1997  7562011 Africa       51.6     1005.
10 Comoros                   1997   527982 Africa       60.7     1174.
# ℹ 42 more rows</code></pre>
<p>The base R equivalent of the above uses the square bracket notation
that we saw earlier with a twist:</p>
<pre class="r"><code>gapminder_1997[gapminder_1997$continent == &#39;Africa&#39;, ]</code></pre>
<pre><code># A tibble: 52 × 6
   country                   year      pop continent lifeExp gdpPercap
   &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Algeria                   1997 29072015 Africa       69.2     4797.
 2 Angola                    1997  9875024 Africa       41.0     2277.
 3 Benin                     1997  6066080 Africa       54.8     1233.
 4 Botswana                  1997  1536536 Africa       52.6     8647.
 5 Burkina Faso              1997 10352843 Africa       50.3      946.
 6 Burundi                   1997  6121610 Africa       45.3      463.
 7 Cameroon                  1997 14195809 Africa       52.2     1694.
 8 Central African Republic  1997  3696513 Africa       46.1      741.
 9 Chad                      1997  7562011 Africa       51.6     1005.
10 Comoros                   1997   527982 Africa       60.7     1174.
# ℹ 42 more rows</code></pre>
<p>Here we put the condition in the row position, before the comma,
because because we want to subset rows. The blank after the comma
indicates we want all the columns returned. An alternative base R way to
do this is:</p>
<pre class="r"><code>subset(gapminder_1997, continent == &#39;Africa&#39;)</code></pre>
<pre><code># A tibble: 52 × 6
   country                   year      pop continent lifeExp gdpPercap
   &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Algeria                   1997 29072015 Africa       69.2     4797.
 2 Angola                    1997  9875024 Africa       41.0     2277.
 3 Benin                     1997  6066080 Africa       54.8     1233.
 4 Botswana                  1997  1536536 Africa       52.6     8647.
 5 Burkina Faso              1997 10352843 Africa       50.3      946.
 6 Burundi                   1997  6121610 Africa       45.3      463.
 7 Cameroon                  1997 14195809 Africa       52.2     1694.
 8 Central African Republic  1997  3696513 Africa       46.1      741.
 9 Chad                      1997  7562011 Africa       51.6     1005.
10 Comoros                   1997   527982 Africa       60.7     1174.
# ℹ 42 more rows</code></pre>
<p>This is quite similar to the <code>tidyverse</code> syntax, except
we’re using the <code>subset()</code> function from base R instead of
<code>filter()</code> from <code>dplyr</code>.</p>
<p>We can filter the data for African countries above a certain
population by using the <code>&amp;</code> operator. Essentially
requiring multiple things to be true at the same time:</p>
<pre class="r"><code>filter(gapminder_1997, continent == &#39;Africa&#39; &amp; pop &gt;= 10000000)</code></pre>
<pre><code># A tibble: 19 × 6
   country          year       pop continent lifeExp gdpPercap
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Algeria          1997  29072015 Africa       69.2     4797.
 2 Burkina Faso     1997  10352843 Africa       50.3      946.
 3 Cameroon         1997  14195809 Africa       52.2     1694.
 4 Congo Dem. Rep.  1997  47798986 Africa       42.6      312.
 5 Cote d&#39;Ivoire    1997  14625967 Africa       48.0     1786.
 6 Egypt            1997  66134291 Africa       67.2     4173.
 7 Ethiopia         1997  59861301 Africa       49.4      516.
 8 Ghana            1997  18418288 Africa       58.6     1005.
 9 Kenya            1997  28263827 Africa       54.4     1360.
10 Madagascar       1997  14165114 Africa       55.0      986.
11 Malawi           1997  10419991 Africa       47.5      692.
12 Morocco          1997  28529501 Africa       67.7     2982.
13 Mozambique       1997  16603334 Africa       46.3      472.
14 Nigeria          1997 106207839 Africa       47.5     1625.
15 South Africa     1997  42835005 Africa       60.2     7479.
16 Sudan            1997  32160729 Africa       55.4     1632.
17 Tanzania         1997  30686889 Africa       48.5      789.
18 Uganda           1997  21210254 Africa       44.6      817.
19 Zimbabwe         1997  11404948 Africa       46.8      792.</code></pre>
</div>
<div id="make-new-columns-with-mutate" class="section level2">
<h2>Make new columns with <code>mutate()</code></h2>
<p>It’s common to use existing columns of a data table to create new
columns. For example, in the <code>gapminder_1997</code> data we have a
<code>pop</code> column and a <code>gdpPercap</code> column. We could
multiply these two columns to get a new <code>gdp</code> column. The
<code>dplyr</code> function <code>mutate()</code> adds columns to an
existing data table.</p>
<pre class="r"><code>mutate(gapminder_1997, gdp = pop * gdpPercap)</code></pre>
<pre><code># A tibble: 142 × 7
   country      year       pop continent lifeExp gdpPercap           gdp
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1 Afghanistan  1997  22227415 Asia         41.8      635.  14121995875.
 2 Albania      1997   3428038 Europe       73.0     3193.  10945912519.
 3 Algeria      1997  29072015 Africa       69.2     4797. 139467033682.
 4 Angola       1997   9875024 Africa       41.0     2277.  22486820881.
 5 Argentina    1997  36203463 Americas     73.3    10967. 397053586287.
 6 Australia    1997  18565243 Oceania      78.8    26998. 501223252921.
 7 Austria      1997   8069876 Europe       77.5    29096. 234800471832.
 8 Bahrain      1997    598561 Asia         73.9    20292.  12146009862.
 9 Bangladesh   1997 123315288 Asia         59.4      973. 119957417048.
10 Belgium      1997  10199787 Europe       77.5    27561. 281118335091.
# ℹ 132 more rows</code></pre>
<p>As before, this didn’t actually add the column to
<code>gapminder_1997</code>, we have to save the object to store it:</p>
<pre class="r"><code>gapminder_gdp_1997 = mutate(gapminder_1997, gdp = pop * gdpPercap)
gapminder_gdp_1997</code></pre>
<pre><code># A tibble: 142 × 7
   country      year       pop continent lifeExp gdpPercap           gdp
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1 Afghanistan  1997  22227415 Asia         41.8      635.  14121995875.
 2 Albania      1997   3428038 Europe       73.0     3193.  10945912519.
 3 Algeria      1997  29072015 Africa       69.2     4797. 139467033682.
 4 Angola       1997   9875024 Africa       41.0     2277.  22486820881.
 5 Argentina    1997  36203463 Americas     73.3    10967. 397053586287.
 6 Australia    1997  18565243 Oceania      78.8    26998. 501223252921.
 7 Austria      1997   8069876 Europe       77.5    29096. 234800471832.
 8 Bahrain      1997    598561 Asia         73.9    20292.  12146009862.
 9 Bangladesh   1997 123315288 Asia         59.4      973. 119957417048.
10 Belgium      1997  10199787 Europe       77.5    27561. 281118335091.
# ℹ 132 more rows</code></pre>
</div>
<div id="combine-functions-with-the-pipe" class="section level2">
<h2>Combine functions with the <code>%&gt;%</code> pipe</h2>
<p>We’ve learned how to subset rows with <code>filter()</code>, select
columns with <code>select()</code>, get distinct elements with
<code>distinct()</code>, and summarize columns with
<code>summarize()</code>. It’s common to use these functions in
sequence, where the output of one becomes the input of the next. The
“pipe” (<code>|</code>) from <code>bash</code> has an equivalent in the
<code>tidyverse</code> in the <code>%&gt;%</code> symbol. To see this,
let’s select data from Oceania and display only the
<code>country</code>, <code>continent</code>, and <code>pop</code>
columns.</p>
<pre class="r"><code>gapminder_1997 %&gt;% filter(continent == &#39;Oceania&#39;) %&gt;% select(country, continent, pop)</code></pre>
<pre><code># A tibble: 2 × 3
  country     continent      pop
  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
1 Australia   Oceania   18565243
2 New Zealand Oceania    3676187</code></pre>
<p>It seems there are only two countries, Australia and New Zealand. If
we wanted to take the mean of the populations we could pipe the above
output to <code>summarize()</code> as in:</p>
<pre class="r"><code>gapminder_1997 %&gt;%
    filter(continent == &#39;Oceania&#39;) %&gt;%
    select(country, continent, pop) %&gt;%
    summarize(oceania_mean_pop = mean(pop))</code></pre>
<pre><code># A tibble: 1 × 1
  oceania_mean_pop
             &lt;dbl&gt;
1         11120715</code></pre>
<p>Note this is distinct from taking the mean over the entire data
set:</p>
<pre class="r"><code>gapminder_1997 %&gt;% summarize(global_mean_pop = mean(pop))</code></pre>
<pre><code># A tibble: 1 × 1
  global_mean_pop
            &lt;dbl&gt;
1       38839468.</code></pre>
<p>Here we’ve meaningfully named our output, but that was optional. For
quick data exploration that could be left off.</p>
</div>
<div id="group-rows-with-group_by" class="section level2">
<h2>Group rows with <code>group_by()</code></h2>
<p>If we wanted to determine the mean populations over all the
continents, we could run the above code we used for Oceania, but replace
Oceania with each continent name. That’s a bit tedious, and the
<code>tidyverse</code> provides a very nice function,
<code>group_by()</code>, that breaks a data table up into groups on
which to perform operations.</p>
<pre class="r"><code>gapminder_1997 %&gt;% 
    group_by(continent) %&gt;% 
    summarize(mean_pop = mean(pop))</code></pre>
<pre><code># A tibble: 5 × 2
  continent   mean_pop
  &lt;chr&gt;          &lt;dbl&gt;
1 Africa     14304480.
2 Americas   31876016.
3 Asia      102523803.
4 Europe     18964805.
5 Oceania    11120715 </code></pre>
<p>Notice that the Oceania average matches what we got above. Going back
to our Oceania subset, we can use <code>group_by()</code> with the
counting function <code>n()</code> to count how many countries there are
per continent in the <code>gapminder_1997</code> data, and verify that
there really only are two:</p>
<pre class="r"><code>gapminder_1997 %&gt;% 
    group_by(continent) %&gt;% 
    summarize(num_countries_per_continent = n())</code></pre>
<pre><code># A tibble: 5 × 2
  continent num_countries_per_continent
  &lt;chr&gt;                           &lt;int&gt;
1 Africa                             52
2 Americas                           25
3 Asia                               33
4 Europe                             30
5 Oceania                             2</code></pre>
<p>There is a base R function, <code>table()</code>, that tabulates the
number of time an entry occurs in a vector, and is useful for quick
sanity checking:</p>
<pre class="r"><code>table(gapminder_1997$continent)</code></pre>
<pre><code>
  Africa Americas     Asia   Europe  Oceania 
      52       25       33       30        2 </code></pre>
</div>
</div>
<div id="exploring-data-visually" class="section level1">
<h1>Exploring data visually</h1>
<p>We have learned how to use <code>tidyverse</code> functions to subset
and summarize data, along with some of the equivalent base R functions.
But all of our manipulations have lacked the visual component that can
be so helpful in understanding the properties of data. Let’s now turn
our attention to plotting in the <code>tidyverse</code> with the
<code>ggplot2</code> package. The <code>ggplot2</code> package is a
powerful, easy to use package that creates publication ready plots, and
is one of the reasons so many people use R.</p>
<p>Let’s jump right in and create our first plot using the
<code>ggplot()</code> function. And along the way we’ll discuss the
components of a plot, and how <code>ggplot2</code> thinks about
plotting.</p>
<pre class="r"><code>ggplot(data = gapminder_1997)</code></pre>
<p><img src="fig/02-plot1-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>When we ran this code the Plots tab popped up and displayed … a gray
rectangle. This is underwhelming as a first plot, but it’s a helpful
reminder that computers do exactly what you tell them. In this case,
we’ve just told R that we want to plot data from the
<code>gapminder_1997</code> data. We haven’t told it
<strong>how</strong>.</p>
<p>The elements of a plot have properties like: x and y position, size,
color, etc. These properties are <strong>aesthetics</strong>, and we
need to map variables in our dataset to aesthetics in our plot. This is
done with the aesthetic mapping function <code>aes()</code>. Let’s build
up our plot iteratively by mapping <code>gdpPercap</code> to the x-axis
with:</p>
<pre class="r"><code>ggplot(data = gapminder_1997) +
    aes(x = gdpPercap)</code></pre>
<p><img src="fig/02-plot2-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>In <code>ggplot2</code>, the <code>+</code> indicates we want to add
elements to a plot. It’s kind of like the pipe (<code>%&gt;%</code>) in
<code>dplyr</code>. Our plot window is no longer a blank gray square,
but now has a labeled x-axis with visual delimiters. Here,
<code>gdpPercap</code> is just the column name from our data, and isn’t
really formatted in a “publication” ready manner. We can use the
<code>labs()</code> function to alter the label on the x-axis with:</p>
<pre class="r"><code>ggplot(data = gapminder_1997) +
    aes(x = gdpPercap) +
    labs(x = &#39;GDP Per Capita&#39;)</code></pre>
<p><img src="fig/02-plot3-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>Now let’s map life expectancy to the y-axis, and add a nice label for
it:</p>
<pre class="r"><code>ggplot(data = gapminder_1997) +
    aes(x = gdpPercap) +
    labs(x = &#39;GDP Per Capita&#39;) +
    aes(y = lifeExp) + 
    labs(y = &#39;Life Expectancy&#39;)</code></pre>
<p><img src="fig/02-plot4-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>This is progress, but we still don’t have any data plotted. For this,
we tell the plot object what to draw by adding a “geometry” (“geom” for
short). There are many geometries, but we’ll begin with
<code>geom_point()</code>, which plots points in the x-y plane.</p>
<pre class="r"><code>ggplot(data = gapminder_1997) +
    aes(x = gdpPercap) +
    labs(x = &#39;GDP Per Capita&#39;) +
    aes(y = lifeExp) + 
    labs(y = &#39;Life Expectancy&#39;) +
    geom_point()</code></pre>
<p><img src="fig/02-plot5-1.png" width="816" style="display: block; margin: auto;" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
